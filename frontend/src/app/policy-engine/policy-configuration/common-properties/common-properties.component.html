<div *ngIf="type != 'Events'" class="grid-setting" [attr.readonly]="readonly">
    <div class="table">
        <table class="header">
            <tr class="propHeader">
                <td class="propRowCol"></td>
                <th class="propHeaderCell cellName">Property</th>
                <th class="propHeaderCell">Value</th>
            </tr>
        </table>
        <div class="table-body">
            <table *ngIf="block" class="properties">
                <tr class="propHeader">
                    <td class="propRowCol" (click)="onHide(propHidden, 'about')" [attr.collapse]="propHidden.about">
                        <mat-icon>
                            expand_more
                        </mat-icon>
                    </td>
                    <td class="propHeaderCell cellName">About</td>
                    <td class="propHeaderCell"></td>
                </tr>
                <tr class="propRow" [attr.collapse]="propHidden.about">
                    <td class="propRowCol"></td>
                    <td class="propRowCell cellName">Type</td>
                    <td class="propRowCell">
                        <span class="readonly-prop">{{block.blockType}}</span>
                    </td>
                </tr>

                <ng-container *ngIf="about">
                    <tr class="propRow" [attr.collapse]="propHidden.about">
                        <td class="propRowCol"></td>
                        <td class="propRowCell cellName">GET</td>
                        <td class="propRowCell">
                            <span class="readonly-prop">{{about.get?'Yes':'No'}}</span>
                        </td>
                    </tr>
                    <tr class="propRow" [attr.collapse]="propHidden.about">
                        <td class="propRowCol"></td>
                        <td class="propRowCell cellName">POST</td>
                        <td class="propRowCell">
                            <span class="readonly-prop">{{about.post?'Yes':'No'}}</span>
                        </td>
                    </tr>
                    <tr class="propRow" [attr.collapse]="propHidden.about">
                        <td class="propRowCol"></td>
                        <td class="propRowCell cellName">Server Input</td>
                        <td class="propRowCell">
                            <span class="readonly-prop">{{about.input}}</span>
                        </td>
                    </tr>
                    <tr class="propRow" [attr.collapse]="propHidden.about">
                        <td class="propRowCol"></td>
                        <td class="propRowCell cellName">Server Output</td>
                        <td class="propRowCell">
                            <span class="readonly-prop">{{about.output}}</span>
                        </td>
                    </tr>
                    <tr class="propRow" [attr.collapse]="propHidden.about">
                        <td class="propRowCol"></td>
                        <td class="propRowCell cellName">Control Type</td>
                        <td class="propRowCell">
                            <span class="readonly-prop">{{about.control}}</span>
                        </td>
                    </tr>
                    <tr class="propRow" [attr.collapse]="propHidden.about">
                        <td class="propRowCol"></td>
                        <td class="propRowCell cellName">Children</td>
                        <td class="propRowCell">
                            <span class="readonly-prop">{{about.children}}</span>
                        </td>
                    </tr>
                </ng-container>

                <tr class="propHeader">
                    <td class="propRowCol" (click)="onHide(propHidden, 'metaData')"
                        [attr.collapse]="propHidden.metaData">
                        <mat-icon>
                            expand_more
                        </mat-icon>
                    </td>
                    <td class="propHeaderCell cellName">Meta Data</td>
                    <td class="propHeaderCell"></td>
                </tr>

                <!-- Meta Data  -->
                <tr class="propRow" [attr.collapse]="propHidden.metaData">
                    <td class="propRowCol"></td>
                    <td class="propRowCell cellName">Tag</td>
                    <td class="propRowCell">
                        <input [(ngModel)]="block.tag" [readonly]="readonly">
                    </td>
                </tr>
                <tr class="propRow" [attr.collapse]="propHidden.metaData">
                    <td class="propRowCol"></td>
                    <td class="propRowCell cellName">Permissions</td>
                    <td class="propRowCell">
                        <mat-select [(ngModel)]="block.permissions" multiple [disabled]="readonly">
                            <mat-option value="OWNER">Owner</mat-option>
                            <mat-option value="NO_ROLE">No Role</mat-option>
                            <mat-option value="ANY_ROLE">Any Role</mat-option>
                            <ng-container *ngIf="roles">
                                <mat-option *ngFor="let item of roles" [value]="item">{{item}}</mat-option>
                            </ng-container>
                        </mat-select>
                    </td>
                </tr>
                <tr class="propRow" [attr.collapse]="propHidden.metaData">
                    <td class="propRowCol"></td>
                    <td class="propRowCell cellName">Default Active</td>
                    <td class="propRowCell">
                        <input type="checkbox" [(ngModel)]="block.defaultActive" [readonly]="readonly">
                    </td>
                </tr>
                <tr class="propRow" [attr.collapse]="propHidden.metaData">
                    <td class="propRowCol"></td>
                    <td class="propRowCell cellName">On errors</td>
                    <td class="propRowCell">
                        <mat-select [(value)]="block.onErrorAction" [disabled]="readonly">
                            <mat-option *ngFor="let item of errorActions" [value]="item.value">{{item.label}}
                            </mat-option>
                        </mat-select>
                    </td>
                </tr>
                <tr *ngIf="block.onErrorAction === 'retry'" class="propRow" [attr.collapse]="propHidden.metaData">
                    <td class="propRowCol"></td>
                    <td class="propRowCell cellName">Timeout</td>
                    <td class="propRowCell">
                        <input type="text" [(ngModel)]="block.errorTimeout" [readonly]="readonly">
                    </td>
                </tr>
                <tr *ngIf="block.onErrorAction === 'goto-step'" class="propRow" [attr.collapse]="propHidden.metaData">
                    <td class="propRowCol"></td>
                    <td class="propRowCell cellName">Fallback step</td>
                    <td class="propRowCell">
                        <input type="text" [(ngModel)]="block.errorFallbackStep" [readonly]="readonly">
                    </td>
                </tr>
                <tr *ngIf="block.onErrorAction === 'goto-tag'" class="propRow" [attr.collapse]="propHidden.metaData">
                    <td class="propRowCol"></td>
                    <td class="propRowCell cellName">Fallback tag</td>
                    <td class="propRowCell">
                        <input type="text" [(ngModel)]="block.errorFallbackTag" [readonly]="readonly">
                    </td>
                </tr>
            </table>
            <template #configContainer></template>
        </div>
    </div>
</div>

<div *ngIf="type == 'Events'" class="grid-setting" [attr.readonly]="readonly">
    <div class="table">
        <table class="header">
            <tr class="propHeader">
                <td class="propRowCol"></td>
                <th class="propHeaderCell cellName">Property</th>
                <th class="propHeaderCell">Value</th>
            </tr>
        </table>
        <div class="table-body">
            <table *ngIf="block" class="properties">
                <ng-container *ngFor="let item of events; let i=index">
                    <tr class="propHeader">
                        <td class="propRowCol" (click)="onHide(propHidden.eventsGroup, i)"
                            [attr.collapse]="propHidden.eventsGroup[i]">
                            <mat-icon>expand_more</mat-icon>
                        </td>
                        <td class="propHeaderCell cellName">
                            <div style="height: 20px;" [attr.disabled]="item.disabled">
                                <span class="prop-icon" style="color: #bd9012; width: 20px !IMPORTANT;">
                                    <mat-icon>flash_on</mat-icon>
                                </span>
                                <span *ngIf="!item.__output" class="prop-icon" style="color: #35a307;">
                                    <mat-icon>arrow_downward</mat-icon>
                                </span>
                                <span *ngIf="item.__output" class="prop-icon" style="color: #c53227;">
                                    <mat-icon>arrow_upward</mat-icon>
                                </span>
                                <span *ngIf="!item.__output" class="prop-icon-text">Input Event</span>
                                <span *ngIf="item.__output" class="prop-icon-text">Output Event</span>
                            </div>
                        </td>
                        <td class="propHeaderCell">
                            <div *ngIf="item.__output" style="height: 20px;" [attr.disabled]="item.disabled">
                                <span class="prop-icon-text">
                                    ({{item.output}})
                                </span>
                                <span class="prop-icon" style="width: 20px !IMPORTANT; color: #c53227;">
                                    <mat-icon style="top: -1px;">arrow_forward</mat-icon>
                                </span>
                                <span class="prop-icon-text">
                                    {{item.target}} ({{item.input}})
                                </span>
                            </div>
                            <div *ngIf="!item.__output" style="height: 20px;" [attr.disabled]="item.disabled">
                                <span class="prop-icon-text">
                                    ({{item.input}})
                                </span>
                                <span class="prop-icon" style="width: 20px !IMPORTANT; color: #35a307;">
                                    <mat-icon style="top: -1px;">arrow_back</mat-icon>
                                </span>
                                <span class="prop-icon-text">
                                    {{item.source}}({{item.output}})
                                </span>
                            </div>
                            <span class="remove-prop" [attr.readonly]="readonly" (click)="onRemoveEvent(i)">
                                <mat-icon>delete</mat-icon>
                            </span>
                        </td>
                    </tr>

                    <tr class="propRow subRow" [attr.collapse]="propHidden.eventsGroup[i]">
                        <td class="propRowCol"></td>
                        <td class="propRowCell cellName">Event Type</td>
                        <td class="propRowCell remove-cell">
                            <mat-select [(value)]="item.__output" [disabled]="readonly">
                                <mat-option [value]="false">Input Event</mat-option>
                                <mat-option [value]="true">Output Event</mat-option>
                            </mat-select>
                        </td>
                    </tr>

                    <tr *ngIf="item.__output" class="propRow subRow" [attr.collapse]="propHidden.eventsGroup[i]">
                        <td class="propRowCol"></td>
                        <td class="propRowCell cellName">Source</td>
                        <td class="propRowCell remove-cell">
                            <span class="readonly-prop">Current Block</span>
                        </td>
                    </tr>
                    <tr *ngIf="!item.__output" class="propRow subRow" [attr.collapse]="propHidden.eventsGroup[i]">
                        <td class="propRowCol"></td>
                        <td class="propRowCell cellName">Source</td>
                        <td class="propRowCell remove-cell">
                            <mat-select [(value)]="item.source" [disabled]="readonly">
                                <mat-option *ngFor="let item of allBlocks" [value]="item.tag">{{item.tag}}</mat-option>
                            </mat-select>
                        </td>
                    </tr>

                    <tr *ngIf="item.__output" class="propRow subRow" [attr.collapse]="propHidden.eventsGroup[i]">
                        <td class="propRowCol"></td>
                        <td class="propRowCell cellName">Target</td>
                        <td class="propRowCell remove-cell">
                            <mat-select [(value)]="item.target" [disabled]="readonly">
                                <mat-option *ngFor="let item of allBlocks" [value]="item.tag">{{item.tag}}</mat-option>
                            </mat-select>
                        </td>
                    </tr>
                    <tr *ngIf="!item.__output" class="propRow subRow" [attr.collapse]="propHidden.eventsGroup[i]">
                        <td class="propRowCol"></td>
                        <td class="propRowCell cellName">Target</td>
                        <td class="propRowCell remove-cell">
                            <span class="readonly-prop">Current Block</span>
                        </td>
                    </tr>

                    <tr class="propRow subRow" [attr.collapse]="propHidden.eventsGroup[i]">
                        <td class="propRowCol"></td>
                        <td class="propRowCell cellName">Output Event</td>
                        <td class="propRowCell remove-cell">
                            <mat-select [(value)]="item.output" [disabled]="readonly">
                                <mat-option value="RunEvent">Run Event</mat-option>
                            </mat-select>
                        </td>
                    </tr>
                    <tr class="propRow subRow" [attr.collapse]="propHidden.eventsGroup[i]">
                        <td class="propRowCol"></td>
                        <td class="propRowCell cellName">Input Event</td>
                        <td class="propRowCell remove-cell">
                            <mat-select [(value)]="item.input" [disabled]="readonly">
                                <mat-option value="RunEvent">Run Event</mat-option>
                            </mat-select>
                        </td>
                    </tr>
                    <tr class="propRow subRow" [attr.collapse]="propHidden.eventsGroup[i]">
                        <td class="propRowCol"></td>
                        <td class="propRowCell cellName">Disabled</td>
                        <td class="propRowCell remove-cell">
                            <input type="checkbox" [(ngModel)]="item.disabled" [readonly]="readonly">
                        </td>
                    </tr>
                </ng-container>
                <tr class="propRow" style="height: 26px;">
                    <td class="propRowCol"></td>
                    <td class="propRowCell cellName"></td>
                    <td class="propRowCell"></td>
                </tr>
                <div class="propBottom">
                    <div class="propAdd" (click)="addEvent()">
                        <mat-icon>add</mat-icon>
                        <span>Add Event</span>
                    </div>
                </div>
            </table>
        </div>
    </div>
</div>